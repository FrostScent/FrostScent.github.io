{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/blog/tensorflow-titanic/",
    "result": {"data":{"markdownRemark":{"html":"<p><code>kaggle</code> 의 튜토리얼이라고도 할 수 있는 타이타닉 생존자 예측하기 문제는 <code>Machine Learning</code> 이나 <code>Deep Learning</code> 입문자라면 누구나 한 번쯤 살펴보게 되는 문제이다.</p>\n<p>가장 간단한 형태의 분류 문제로서, 특별한 기교가 있는 건 아니지만 모델 학습을 시작하기 전 전처리의 기본은 한 번씩 구현해 볼만한 주제라 아래에 정리해 보려고 한다.</p>\n<p>본 포스팅에서는 전처리를 위한 Package 로 <code>Scikit Learn</code> 을 사용하고 <code>Tensor Flow</code> 를 이용한 Deep Learning 으로 결과를 예측해 보았다.\r\n<br/>\r\n<br/></p>\n<h1>주제</h1>\n<hr>\n<p>본 모델은 타이타닉 호 침몰 당시 사망에 영향을 끼칠만한 요인 분석을 통해 승객의 생존 여부를 예측하고자 함이다.</p>\n<p>Kaggle 및 데이터 파일은 아래 링크를 참고한다.</p>\n<p><a href=\"https://www.kaggle.com/c/titanic\">kaggle link</a>\r\n<br/>\r\n<br/></p>\n<h1>변수 설명</h1>\n<hr>\n<h3>PassengerId : 각 승객의 고유 번호</h3>\n<h3>Servived : 생존 여부 (종속 변수)</h3>\n<ul>\n<li>0 = 사망</li>\n<li>1 = 생존</li>\n</ul>\n<h3>Pclass : 객실 등급</h3>\n<ul>\n<li>1st = Upper</li>\n<li>2nd = Middle</li>\n<li>3rd = Lower</li>\n</ul>\n<h3>Name : 이름</h3>\n<h3>Sex : 성별</h3>\n<h3>Age : 나이</h3>\n<h3>SibSp : 동반한 형제자매, 배우자 수</h3>\n<h3>Parch : 동반한 부모, 자식 수</h3>\n<h3>Ticket : 티켓 번호</h3>\n<h3>Fare : 티켓 요금</h3>\n<h3>Cabin : 객실 번호</h3>\n<h3>Embarked : 승선한 항</h3>\n<ul>\n<li>C = Cherbourg</li>\n<li>Q = Queenstown</li>\n<li>S = Southampton</li>\n</ul>\n<br/>\r\n<br/>\n<h1>Code</h1>\n<hr>\n<h3><code>Tensorflow</code>, <code>Pandas</code>, <code>Numpy</code> Package Import</h3>\n<pre class=\"grvsc-container github-light-theme grvsc-ps-t4tStz\" data-language=\"python\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">import</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> tensorflow </span><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">as</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> tf</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">import</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> numpy </span><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">as</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> np</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">import</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> pandas </span><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">as</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> pd</span></span></span></code></pre>\n<h3>train, test csv 파일을 <code>Pandas</code> 로 load</h3>\n<pre class=\"grvsc-container github-light-theme grvsc-ps-t4tStz\" data-language=\"python\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">train_df </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> pd.read_csv(</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;train.csv&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">test_df </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> pd.read_csv(</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;test.csv&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">{</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">%</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> endhighlight </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">%</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">}</span></span></span></code></pre>\n<h3>train, test dataset 검토</h3>\n<blockquote>\n<p>각 <code>Datatable</code> 을 조회  해서 어떤 <code>Column</code> 들이 포함되어 있는지, 어떤 형태의 값들이 들어 있는지, <code>NaN</code> 값이나 이상치가 보이는지 검토한다.</p>\n</blockquote>\n<pre class=\"grvsc-container github-light-theme grvsc-ps-t4tStz\" data-language=\"python\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># 위에서 5개 열 조회</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">train_df.head()</span></span></span></code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.337423312883436%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAfklEQVQI1yWLQQ7AIAjA9pSJDD2IiKLD/39syeyxaS9mnnOa2ZyzlJJSyjmLiKq6e+/d3c1MRFJKay0zc/e1FjNfAHDfd4wRAIio/JjZ3nuM0VqrtYYQiIiZVfUYRAwhXGfDnxPlnFX1fd8xRq2VmRGRiGKMrbXeu4g8zwMAH3pBHwwGLMkOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2021 01 17 tensorflow titanic 1\"\n        title=\"2021 01 17 tensorflow titanic 1\"\n        src=\"/static/a5d83b354c484153f7b92b8ca700381f/a6d36/2021-01-17-tensorflow-titanic-1.png\"\n        srcset=\"/static/a5d83b354c484153f7b92b8ca700381f/222b7/2021-01-17-tensorflow-titanic-1.png 163w,\n/static/a5d83b354c484153f7b92b8ca700381f/ff46a/2021-01-17-tensorflow-titanic-1.png 325w,\n/static/a5d83b354c484153f7b92b8ca700381f/a6d36/2021-01-17-tensorflow-titanic-1.png 650w,\n/static/a5d83b354c484153f7b92b8ca700381f/e548f/2021-01-17-tensorflow-titanic-1.png 975w,\n/static/a5d83b354c484153f7b92b8ca700381f/75a80/2021-01-17-tensorflow-titanic-1.png 1134w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br/>\n<h3>결측치 검토</h3>\n<blockquote>\n<p><code>Datatable</code> 의 <code>.isna().sum()</code> 함수를 이용해서 결측치가 몇 개나 있는지 확인한다.</p>\n</blockquote>\n<p><code>Age</code> 와 <code>Cabin</code>, <code>Embarked</code> 항목에 <code>NaN</code> 값이 들어가 있는 것을 확인할 수 있다.</p>\n<pre class=\"grvsc-container github-light-theme grvsc-ps-t4tStz\" data-language=\"python\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># 결측치 조회</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">train_df.isna().sum()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">PassengerId      </span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">Survived         </span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">Pclass           </span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">Name             </span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">Sex              </span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">Age            </span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">177</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">SibSp            </span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">Parch            </span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">Ticket           </span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">Fare             </span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">Cabin          </span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">687</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">Embarked         </span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">dtype: int64</span></span></span></code></pre>\n<br/>\n<h3>결측치 보정</h3>\n<blockquote>\n<p>모델 생성을 위해 Table 의 결측치 값을 채워줘야 한다.</p>\n</blockquote>\n<p><code>Cabin</code> 과 <code>Embarked</code> 값은 재워주지 않고 <code>Age</code> 값만 채워주기로 하였다. 나머지 두 값의 공란을 안 채우는 이유는 아래에 후술한다.</p>\n<p>이를 위해 <code>sklearn</code> 의 <code>SimpleImputer</code> 를 사용할 것이며, 빈 값을 해당 Column 의 평균 (<code>mean</code>) 값으로 채워주게 하였다.</p>\n<p><code>SimpleImputer</code> 의 <code>Strategy</code> 를 <code>mean</code> 이 아닌 <code>median</code>(중앙값), <code>most_frequent</code>(최빈값), <code>constant</code> (특정값, fill_value 설정 필요) 으로 설정할 수도 있다.</p>\n<pre class=\"grvsc-container github-light-theme grvsc-ps-t4tStz\" data-language=\"python\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># Import SimpleImputer</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">from</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> sklearn.impute </span><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">import</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> SimpleImputer</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># padding 함수 정의</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">def</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> </span><span class=\"grvsc-tiszgT-10 grvsc-t4tStz-5\">nan_padding</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">(</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-6\">data</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">,</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-6\">columns</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">    </span><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">for</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> column </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">in</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> columns:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">        imputer </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> SimpleImputer(</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">strategy</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;mean&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">        data[column] </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> imputer.fit_transform(data[[column]])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">    </span><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">return</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># padding 할 항목 선택 (Age)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">nan_columns </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> [</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;Age&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># padding 실행</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">train_df </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> nan_padding(train_df,nan_columns)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">test_df </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> nan_padding(test_df,nan_columns)</span></span></span></code></pre>\n<br/>\n<h3>필요 없는 Column 제거</h3>\n<blockquote>\n<p>생존 여부를 예측하는데에 도움이 안 되는 Column 을 제거한다.</p>\n</blockquote>\n<p>생존 여부와 관계가 없는 값이 모델 학습에 이용되는 경우 모델의 정확도를 떨어뜨리기 때문에 제거해 주는 것이 좋다.</p>\n<pre class=\"grvsc-container github-light-theme grvsc-ps-t4tStz\" data-language=\"python\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># drop 함수 정의</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">def</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> </span><span class=\"grvsc-tiszgT-10 grvsc-t4tStz-5\">drop_not_concerned</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">(</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-6\">data</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">,</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-6\">columns</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">    </span><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">return</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> data.drop(columns,</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">axis</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">1</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># 제거할 항목 선택</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">not_concerned </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> [</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;PassengerId&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">,</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;Name&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">,</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;Ticket&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">,</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;Fare&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">,</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;Cabin&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">,</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;Embarked&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># drop 실행</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">train_df </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> drop_not_concerned(train_df,not_concerned)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">test_df </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> drop_not_concerned(test_df,not_concerned)</span></span></span></code></pre>\n<br/>\n<h3><code>One-hot Encoding</code></h3>\n<blockquote>\n<p>범주형 항목 (몇 가지 값중 선택하는 경우) 은 그대로 학습 시키지 않고 <code>One-hot encoding</code> 을 통해 값을 각 항목에 해당하는 Column (0 또는 1 값을 가지는) 으로 변환해서 학습시켜야 한다.</p>\n</blockquote>\n<p>예를 들어 이 모델에서 <code>PClass</code> 값이 1, 2, 또는 3 의 값을 가지고 있는데 이런 경우 PClass Column 을 <code>PClass_1</code>, <code>PClass_2</code>, <code>PClass_3</code> 으로 나눈다.</p>\n<p>만약 해당 인원의 <code>PClass</code> 값이 1이라면 <code>PClass_1</code> 의 값을 1로 놓고 <code>PClass_2</code>, <code>PClass_3</code> 의 값을 0 으로 둔다.</p>\n<p><code>PClass</code> 를 그대로 1,2,3 의 값인 상태로 모델을 학습시키면 값이 값이 높을 경우의 <code>PClass</code> 영향도가 더 커질 수 있다. 숫자 값의 크고 작음이 생존 여부와 직결되지 않는다면 <code>One-hot encoding</code> 을 하는 것이 좋다.</p>\n<p><code>One-hot encoding</code> 에 대한 자세한 설명은 별도 포스팅이 필요할 거 같다...</p>\n<p><code>One-hot encoding</code> 을 하는 방법은 여러가지가 있는데, 여기에서는 <code>Pandas</code> 의 <code>get_dummies</code> 를 활용한다.</p>\n<pre class=\"grvsc-container github-light-theme grvsc-ps-t4tStz\" data-language=\"python\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># One-hot encoding 함수 정의</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">def</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> </span><span class=\"grvsc-tiszgT-10 grvsc-t4tStz-5\">dummy_data</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">(</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-6\">data</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">, </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-6\">columns</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">    </span><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">for</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> column </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">in</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> columns:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">        data </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> pd.concat([data,pd.get_dummies(data[column], </span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">prefix</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">column)],</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">axis</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">1</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">        data </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> data.drop(column,</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">axis</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">1</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">    </span><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">return</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># Encoding 대상 선택</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">dummy_columns </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> [</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;Pclass&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># One-hot encoding 실행</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">train_df </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> dummy_data(train_df,dummy_columns)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">test_df </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> dummy_data(test_df,dummy_columns)</span></span></span></code></pre>\n<br/>\n<h3><code>Label Encoding</code></h3>\n<blockquote>\n<p>숫자 값이 아닌 문자열 값의 경우 모델 학습이 불가능하므로, 각 문자열 값을 숫자로 치환해 줘야 한다.</p>\n</blockquote>\n<p>이 모델에서는 Sex 값이 문자열로 되어 있다.</p>\n<p><code>One-hot encoding</code> 을 사용하면 Sex_mail, Sex_femail 이라는 두 Column 으로 값을 나눠 주겠지만, <code>Label encoding</code> 은 Sex 값을 mail, femail 값 각각 0, 1 로 변환해 준다.</p>\n<p>만약 Sex 의 값이 3개 이상의 범주로 형성되어 있다면 <code>One-hot encoding</code> 이 더 적절하지만, 남자인지 '여부' 가 생존에 영향을 끼쳤다면 0,1 값으로 학습을 시켜도 충분한 결과를 얻을 수 있다.</p>\n<p><code>sklearn</code> 의 <code>LabelEncoder</code> 를 활용해 보자.</p>\n<pre class=\"grvsc-container github-light-theme grvsc-ps-t4tStz\" data-language=\"python\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># Import LabelEncoder</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">from</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> sklearn.preprocessing </span><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">import</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> LabelEncoder</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># Label Encoding 함수 정의</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">def</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> </span><span class=\"grvsc-tiszgT-10 grvsc-t4tStz-5\">sex_to_int</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">(</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-6\">data</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">    le </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> LabelEncoder()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">    le.fit([</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;male&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">,</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;female&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">    data[</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;Sex&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">] </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> le.transform(data[</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;Sex&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">    </span><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">return</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># 함수 실행</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">train_df </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> sex_to_int(train_df)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">test_df </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> sex_to_int(test_df)</span></span></span></code></pre>\n<br/>\n<h3><code>Data Normalization</code> (정규화)</h3>\n<blockquote>\n<p>만약 특정 Column 의 값이 다른 Column 의 값들보다 Scale 이 크고 변동폭이 크다면 해당 Column 이 모델에 실제보다 더 큰 영향을 끼칠 가능성이 크다.</p>\n</blockquote>\n<p>이를 방지하기 위해 해당 값을 특정 범위 이내로 정규화 해 주는 작업이 필요하다.</p>\n<p>정규화에는 여러가지 방법이 있으며 본 포스팅에서는 <code>sklearn</code> 의 <code>MinMaxScaler</code> 를 활용한다.</p>\n<p><code>Age</code> 를 제외한 나머지 값은 모두 0 또는 1 의 값을 가지고 있지만 <code>Age</code> 의 값은 수십 이상의 값을 가지고 있기 때문에 <code>Age</code> 값을 정규화 해 보자.</p>\n<pre class=\"grvsc-container github-light-theme grvsc-ps-t4tStz\" data-language=\"python\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># Import MinMaxScaler </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">from</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> sklearn.preprocessing </span><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">import</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> MinMaxScaler</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># 정규화 함수 정의</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">def</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> </span><span class=\"grvsc-tiszgT-10 grvsc-t4tStz-5\">normalize</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">(</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-6\">data</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">,</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-6\">columns</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">    </span><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">for</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> column </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">in</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> columns:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">        scaler </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> MinMaxScaler()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">        data[column] </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> scaler.fit_transform(data[[column]])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">    </span><span class=\"grvsc-tiszgT-5 grvsc-t4tStz-9\">return</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># 정규화 대상 Column 정의</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">normalize_columns </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> [</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;Age&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># 함수 실행</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">train_df </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> normalize(train_df,normalize_columns)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">test_df </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> normalize(test_df,normalize_columns)</span></span></span></code></pre>\n<br/>\n<h3>결과값 분리</h3>\n<blockquote>\n<p>본 데이터 셋은 학습 데이터와 결과 값 (생존여부 <code>Survived</code>) 이 하나의 Table 로 되어 있기 때문에 y 값을 분리해 주는 작업이 필요하다.</p>\n</blockquote>\n<p>Test 데이터셋의 생존 여부 값이 <code>gender_submission.csv</code> 라는 별도 파일로 있다.</p>\n<pre class=\"grvsc-container github-light-theme grvsc-ps-t4tStz\" data-language=\"python\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># Train Data frame 복사 후 &#39;survived&#39; Column 을 분리</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">train_X </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> train_df.copy()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">train_y </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> train_X.pop(</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;Survived&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># Test Data frame 복사 후 생존 여부 값은 &#39;gender_submission.csv&#39; 파일에서 가져옴</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">test_X </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> test_df.copy()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">test_y </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> pd.read_csv(</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;gender_submission.csv&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">test_y.drop(</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;PassengerId&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">,</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">axis</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">1</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">,</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">inplace</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">True</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">)</span></span></span></code></pre>\n<br/>\n<h3><code>Tensor Flow</code> 모델 정의</h3>\n<p>드디어 전처리가 완료 되었고 모델 학습을 시작할 수 있다.</p>\n<p>0 (사망) 또는 1 (생존) 을 예측하는 분류 문제이기 때문에 <code>Loss</code> 로는 <code>BinaryCrossentropy</code>, 출력 Layer 의 활성화 함수는 <code>sigmoid</code> 를 사용하였다.</p>\n<p><code>Optimizer</code> 는 <code>Adam</code> 을 사용하였고, 중간 Dense Layer 구조는 특별할 게 없다.</p>\n<pre class=\"grvsc-container github-light-theme grvsc-ps-t4tStz\" data-language=\"python\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">loss </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> tf.keras.losses.BinaryCrossentropy()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">optimizer </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> tf.keras.optimizers.Adam()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">model </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> tf.keras.Sequential()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">model.add(tf.keras.layers.Input(</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">shape</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">[</span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-1\">len</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">(train_X.keys())]))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">model.add(tf.keras.layers.Dense(</span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">64</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">,</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">activation</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;relu&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">model.add(tf.keras.layers.Dense(</span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">32</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">,</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">activation</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;relu&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">model.add(tf.keras.layers.Dense(</span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">1</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">,</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">activation</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;sigmoid&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">model.compile(</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">optimizer</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">optimizer,</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">loss</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">loss,</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">metrics</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">[</span><span class=\"grvsc-tiszgT-8 grvsc-t4tStz-10\">&#39;acc&#39;</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span></code></pre>\n<br/>\n<h3><code>Tensor Flow</code> 모델 학습</h3>\n<p>앞에서 정의한 모델을 전처리 완료한 데이터 기반으로 학습해보자.</p>\n<pre class=\"grvsc-container github-light-theme grvsc-ps-t4tStz\" data-language=\"python\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># 500 Epoch</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">epoch </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> </span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">500</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># 20% 의 Train 데이터를 Validation 으로 활용</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">valid_split </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> </span><span class=\"grvsc-tiszgT-7 grvsc-t4tStz-3\">0.2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-6 grvsc-t4tStz-2\"># 학습 실행 후 history 에 진행 결과를 저장</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">history </span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\"> model.fit(</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">x</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">train_X,</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">y</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">train_y,</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">epochs</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">epoch,</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">validation_split</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">valid_split)</span></span></span></code></pre>\n<br/>\n<h3>학습 결과 테스트</h3>\n<pre class=\"grvsc-container github-light-theme grvsc-ps-t4tStz\" data-language=\"python\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">model.evaluate(</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">x</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">test_X,</span><span class=\"grvsc-tiszgT-11 grvsc-t4tStz-6\">y</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-9\">=</span><span class=\"grvsc-tiszgT-1 grvsc-t4tStz-1\">test_y)</span></span></span></code></pre>\n<br/>\n<p>학습 결과 값은 아래와 같다.</p>\n<p>[0.35380762815475464, 0.9234449863433838]</p>\n<p>92.3% 확률로 생전 여부를 맞출 수 있었다.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .github-light-theme {\n    background-color: #ffffff;\n    color: #000000;\n  }\n  .github-light-theme .grvsc-tiszgT-5 { color: #D73A49; }\n  .github-light-theme .grvsc-tiszgT-1 { color: #000000; }\n  .github-light-theme .grvsc-tiszgT-8 { color: #032F62; }\n  .github-light-theme .grvsc-tiszgT-6 { color: #6A737D; }\n  .github-light-theme .grvsc-tiszgT-7 { color: #005CC5; }\n  .github-light-theme .grvsc-tiszgT-10 { color: #6F42C1; }\n  .github-light-theme .grvsc-tiszgT-11 { color: #E36209; }\n  .github-light-theme .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));\n  }\n  body[data-theme=dark] .grvsc-ps-t4tStz { color: #ffffff; }\n  body[data-theme=dark] .grvsc-ps-t4tStz .grvsc-t4tStz-9 { color: #EB7E81; }\n  body[data-theme=dark] .grvsc-ps-t4tStz .grvsc-t4tStz-1 { color: #FFFFFF; }\n  body[data-theme=dark] .grvsc-ps-t4tStz .grvsc-t4tStz-10 { color: #9DCDF5; }\n  body[data-theme=dark] .grvsc-ps-t4tStz .grvsc-t4tStz-2 { color: #A19B8F; }\n  body[data-theme=dark] .grvsc-ps-t4tStz .grvsc-t4tStz-3 { color: #66B5F6; }\n  body[data-theme=dark] .grvsc-ps-t4tStz .grvsc-t4tStz-5 { color: #BB97E7; }\n  body[data-theme=dark] .grvsc-ps-t4tStz .grvsc-t4tStz-6 { color: #F39961; }\n  body[data-theme=dark] .grvsc-ps-t4tStz .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));\n  }\n</style>","frontmatter":{"title":"[Tensorflow] Titanic (타이타닉) 생존자 예측하기","desc":"Tensorflow Titanic 생존자 예측","thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAwAF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB1Ccxaj//xAAZEAEAAwEBAAAAAAAAAAAAAAABAAISAxH/2gAIAQEAAQUCtbMOgsT2YqM//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhABAQEAAAAAAAAAAAAAAAAAEDEA/9oACAEBAAY/AtWH/8QAGBABAQEBAQAAAAAAAAAAAAAAAQAxEBH/2gAIAQEAAT8hLUeARkGj2AEBz//aAAwDAQACAAMAAAAQU8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEBAQEBAQAAAAAAAAAAAAABEQAhQWH/2gAIAQEAAT8QEtyeZAZWS5WscBD6Za5fDBznN//Z"},"images":{"fallback":{"src":"/static/735a6134f4096794c79571a5fef8cacd/78add/thumbnail.jpg","srcSet":"/static/735a6134f4096794c79571a5fef8cacd/78add/thumbnail.jpg 1920w","sizes":"1920px"},"sources":[{"srcSet":"/static/735a6134f4096794c79571a5fef8cacd/66e4f/thumbnail.webp 1920w","type":"image/webp","sizes":"1920px"}]},"width":1920,"height":1105}}},"date":"2021-01-18","category":"TensorFlow"}}},"pageContext":{"slug":"/blog/tensorflow-titanic/"}},
    "staticQueryHashes": ["1840460387"]}